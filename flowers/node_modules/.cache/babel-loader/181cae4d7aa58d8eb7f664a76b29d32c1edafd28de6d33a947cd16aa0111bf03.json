{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar core = require('@vueuse/core');\nrequire('../../constants/index.js');\nvar aria = require('../../constants/aria.js');\nconst modalStack = [];\nconst closeModal = e => {\n  if (modalStack.length === 0) return;\n  if (e.code === aria.EVENT_CODE.esc) {\n    e.stopPropagation();\n    const topModal = modalStack[modalStack.length - 1];\n    topModal.handleClose();\n  }\n};\nconst useModal = (instance, visibleRef) => {\n  vue.watch(visibleRef, val => {\n    if (val) {\n      modalStack.push(instance);\n    } else {\n      modalStack.splice(modalStack.indexOf(instance), 1);\n    }\n  });\n};\nif (core.isClient) core.useEventListener(document, \"keydown\", closeModal);\nexports.useModal = useModal;","map":{"version":3,"names":["modalStack","closeModal","e","length","code","aria","EVENT_CODE","esc","stopPropagation","topModal","handleClose","useModal","instance","visibleRef","vue","watch","val","push","splice","indexOf","core","isClient","useEventListener","document"],"sources":["../../../../../packages/hooks/use-modal/index.ts"],"sourcesContent":["import { watch } from 'vue'\nimport { isClient, useEventListener } from '@vueuse/core'\nimport { EVENT_CODE } from '@element-plus/constants'\n\nimport type { Ref } from 'vue'\n\ntype ModalInstance = {\n  handleClose: () => void\n}\n\nconst modalStack: ModalInstance[] = []\n\nconst closeModal = (e: KeyboardEvent) => {\n  if (modalStack.length === 0) return\n  if (e.code === EVENT_CODE.esc) {\n    e.stopPropagation()\n    const topModal = modalStack[modalStack.length - 1]\n    topModal.handleClose()\n  }\n}\n\nexport const useModal = (instance: ModalInstance, visibleRef: Ref<boolean>) => {\n  watch(visibleRef, (val) => {\n    if (val) {\n      modalStack.push(instance)\n    } else {\n      modalStack.splice(modalStack.indexOf(instance), 1)\n    }\n  })\n}\n\nif (isClient) useEventListener(document, 'keydown', closeModal)\n"],"mappings":";;;;;;;;;;AAGA,MAAMA,UAAU,GAAG,EAAE;AACrB,MAAMC,UAAU,GAAIC,CAAC,IAAK;EACxB,IAAIF,UAAU,CAACG,MAAM,KAAK,CAAC,EACzB;EACF,IAAID,CAAC,CAACE,IAAI,KAAKC,IAAA,CAAAC,UAAU,CAACC,GAAG,EAAE;IAC7BL,CAAC,CAACM,eAAe,EAAE;IACnB,MAAMC,QAAQ,GAAGT,UAAU,CAACA,UAAU,CAACG,MAAM,GAAG,CAAC,CAAC;IAClDM,QAAQ,CAACC,WAAW,EAAE;EAC1B;AACA,CAAC;AACW,MAACC,QAAQ,GAAGA,CAACC,QAAQ,EAAEC,UAAU,KAAK;EAChDC,GAAA,CAAAC,KAAK,CAACF,UAAU,EAAGG,GAAG,IAAK;IACzB,IAAIA,GAAG,EAAE;MACPhB,UAAU,CAACiB,IAAI,CAACL,QAAQ,CAAC;IAC/B,CAAK,MAAM;MACLZ,UAAU,CAACkB,MAAM,CAAClB,UAAU,CAACmB,OAAO,CAACP,QAAQ,CAAC,EAAE,CAAC,CAAC;IACxD;EACA,CAAG,CAAC;AACJ;AACA,IAAIQ,IAAA,CAAAC,QAAQ,EACVD,IAAA,CAAAE,gBAAgB,CAACC,QAAQ,EAAE,SAAS,EAAEtB,UAAU,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}