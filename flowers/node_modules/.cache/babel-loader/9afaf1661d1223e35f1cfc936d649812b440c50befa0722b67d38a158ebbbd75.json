{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar lodashUnified = require('lodash-unified');\nrequire('../../../../hooks/index.js');\nvar constants = require('../constants.js');\nvar utils = require('../utils.js');\nvar index = require('../../../../hooks/use-popper/index.js');\nconst DEFAULT_ARROW_OFFSET = 0;\nconst usePopperContent = props => {\n  const {\n    popperInstanceRef,\n    contentRef,\n    triggerRef,\n    role\n  } = vue.inject(constants.POPPER_INJECTION_KEY, void 0);\n  const arrowRef = vue.ref();\n  const arrowOffset = vue.ref();\n  const eventListenerModifier = vue.computed(() => {\n    return {\n      name: \"eventListeners\",\n      enabled: !!props.visible\n    };\n  });\n  const arrowModifier = vue.computed(() => {\n    var _a;\n    const arrowEl = vue.unref(arrowRef);\n    const offset = (_a = vue.unref(arrowOffset)) != null ? _a : DEFAULT_ARROW_OFFSET;\n    return {\n      name: \"arrow\",\n      enabled: !lodashUnified.isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset\n      }\n    };\n  });\n  const options = vue.computed(() => {\n    return {\n      onFirstUpdate: () => {\n        update();\n      },\n      ...utils.buildPopperOptions(props, [vue.unref(arrowModifier), vue.unref(eventListenerModifier)])\n    };\n  });\n  const computedReference = vue.computed(() => utils.unwrapMeasurableEl(props.referenceEl) || vue.unref(triggerRef));\n  const {\n    attributes,\n    state,\n    styles,\n    update,\n    forceUpdate,\n    instanceRef\n  } = index.usePopper(computedReference, contentRef, options);\n  vue.watch(instanceRef, instance => popperInstanceRef.value = instance);\n  vue.onMounted(() => {\n    vue.watch(() => {\n      var _a;\n      return (_a = vue.unref(computedReference)) == null ? void 0 : _a.getBoundingClientRect();\n    }, () => {\n      update();\n    });\n  });\n  return {\n    attributes,\n    arrowRef,\n    contentRef,\n    instanceRef,\n    state,\n    styles,\n    role,\n    forceUpdate,\n    update\n  };\n};\nexports.usePopperContent = usePopperContent;","map":{"version":3,"names":["DEFAULT_ARROW_OFFSET","usePopperContent","props","popperInstanceRef","contentRef","triggerRef","role","vue","inject","constants","POPPER_INJECTION_KEY","arrowRef","ref","arrowOffset","eventListenerModifier","computed","name","enabled","visible","arrowModifier","_a","arrowEl","unref","offset","lodashUnified","isUndefined","options","element","padding","onFirstUpdate","update","utils","buildPopperOptions","computedReference","unwrapMeasurableEl","referenceEl","attributes","state","styles","forceUpdate","instanceRef","index","usePopper","watch","instance","value","onMounted","getBoundingClientRect"],"sources":["../../../../../../../packages/components/popper/src/composables/use-content.ts"],"sourcesContent":["import { computed, inject, onMounted, ref, unref, watch } from 'vue'\nimport { isUndefined } from 'lodash-unified'\nimport { usePopper } from '@element-plus/hooks'\nimport { POPPER_INJECTION_KEY } from '../constants'\nimport { buildPopperOptions, unwrapMeasurableEl } from '../utils'\n\nimport type { Modifier } from '@popperjs/core'\nimport type { PartialOptions } from '@element-plus/hooks'\nimport type { PopperContentProps } from '../content'\n\nconst DEFAULT_ARROW_OFFSET = 0\n\nexport const usePopperContent = (props: PopperContentProps) => {\n  const { popperInstanceRef, contentRef, triggerRef, role } = inject(\n    POPPER_INJECTION_KEY,\n    undefined\n  )!\n\n  const arrowRef = ref<HTMLElement>()\n  const arrowOffset = ref<number>()\n\n  const eventListenerModifier = computed(() => {\n    return {\n      name: 'eventListeners',\n      enabled: !!props.visible,\n    } as Modifier<'eventListeners', any>\n  })\n\n  const arrowModifier = computed(() => {\n    const arrowEl = unref(arrowRef)\n    const offset = unref(arrowOffset) ?? DEFAULT_ARROW_OFFSET\n    // Seems like the `phase` and `fn` is required by Modifier type\n    // But on its documentation they didn't specify that.\n    // Refer to https://popper.js.org/docs/v2/modifiers/arrow/\n    return {\n      name: 'arrow',\n      enabled: !isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset,\n      },\n    } as any\n  })\n\n  const options = computed<PartialOptions>(() => {\n    return {\n      onFirstUpdate: () => {\n        update()\n      },\n      ...buildPopperOptions(props, [\n        unref(arrowModifier),\n        unref(eventListenerModifier),\n      ]),\n    }\n  })\n\n  const computedReference = computed(\n    () => unwrapMeasurableEl(props.referenceEl) || unref(triggerRef)\n  )\n\n  const { attributes, state, styles, update, forceUpdate, instanceRef } =\n    usePopper(computedReference, contentRef, options)\n\n  watch(instanceRef, (instance) => (popperInstanceRef.value = instance))\n\n  onMounted(() => {\n    watch(\n      () => unref(computedReference)?.getBoundingClientRect(),\n      () => {\n        update()\n      }\n    )\n  })\n\n  return {\n    attributes,\n    arrowRef,\n    contentRef,\n    instanceRef,\n    state,\n    styles,\n    role,\n\n    forceUpdate,\n    update,\n  }\n}\n\nexport type UsePopperContentReturn = ReturnType<typeof usePopperContent>\n"],"mappings":";;;;;;;;;;;AAKA,MAAMA,oBAAoB,GAAG,CAAC;AAClB,MAACC,gBAAgB,GAAIC,KAAK,IAAK;EACzC,MAAM;IAAEC,iBAAiB;IAAEC,UAAU;IAAEC,UAAU;IAAEC;EAAI,CAAE,GAAGC,GAAA,CAAAC,MAAM,CAACC,SAAA,CAAAC,oBAAoB,EAAE,KAAK,CAAC,CAAC;EAChG,MAAMC,QAAQ,GAAGJ,GAAA,CAAAK,GAAG,EAAE;EACtB,MAAMC,WAAW,GAAGN,GAAA,CAAAK,GAAG,EAAE;EACzB,MAAME,qBAAqB,GAAGP,GAAA,CAAAQ,QAAQ,CAAC,MAAM;IAC3C,OAAO;MACLC,IAAI,EAAE,gBAAgB;MACtBC,OAAO,EAAE,CAAC,CAACf,KAAK,CAACgB;IACvB,CAAK;EACL,CAAG,CAAC;EACF,MAAMC,aAAa,GAAGZ,GAAA,CAAAQ,QAAQ,CAAC,MAAM;IACnC,IAAIK,EAAE;IACN,MAAMC,OAAO,GAAGd,GAAA,CAAAe,KAAK,CAACX,QAAQ,CAAC;IAC/B,MAAMY,MAAM,GAAG,CAACH,EAAE,GAAGb,GAAA,CAAAe,KAAK,CAACT,WAAW,CAAC,KAAK,IAAI,GAAGO,EAAE,GAAGpB,oBAAoB;IAC5E,OAAO;MACLgB,IAAI,EAAE,OAAO;MACbC,OAAO,EAAE,CAACO,aAAA,CAAAC,WAAW,CAACJ,OAAO,CAAC;MAC9BK,OAAO,EAAE;QACPC,OAAO,EAAEN,OAAO;QAChBO,OAAO,EAAEL;MACjB;IACA,CAAK;EACL,CAAG,CAAC;EACF,MAAMG,OAAO,GAAGnB,GAAA,CAAAQ,QAAQ,CAAC,MAAM;IAC7B,OAAO;MACLc,aAAa,EAAEA,CAAA,KAAM;QACnBC,MAAM,EAAE;MAChB,CAAO;MACD,GAAGC,KAAA,CAAAC,kBAAkB,CAAC9B,KAAK,EAAE,CAC3BK,GAAA,CAAAe,KAAK,CAACH,aAAa,CAAC,EACpBZ,GAAA,CAAAe,KAAK,CAACR,qBAAqB,CAAC,CAC7B;IACP,CAAK;EACL,CAAG,CAAC;EACF,MAAMmB,iBAAiB,GAAG1B,GAAA,CAAAQ,QAAQ,CAAC,MAAMgB,KAAA,CAAAG,kBAAkB,CAAChC,KAAK,CAACiC,WAAW,CAAC,IAAI5B,GAAA,CAAAe,KAAK,CAACjB,UAAU,CAAC,CAAC;EACpG,MAAM;IAAE+B,UAAU;IAAEC,KAAK;IAAEC,MAAM;IAAER,MAAM;IAAES,WAAW;IAAEC;EAAW,CAAE,GAAGC,KAAA,CAAAC,SAAS,CAACT,iBAAiB,EAAE7B,UAAU,EAAEsB,OAAO,CAAC;EACzHnB,GAAA,CAAAoC,KAAK,CAACH,WAAW,EAAGI,QAAQ,IAAKzC,iBAAiB,CAAC0C,KAAK,GAAGD,QAAQ,CAAC;EACpErC,GAAA,CAAAuC,SAAS,CAAC,MAAM;IACdvC,GAAA,CAAAoC,KAAK,CAAC,MAAM;MACV,IAAIvB,EAAE;MACN,OAAO,CAACA,EAAE,GAAGb,GAAA,CAAAe,KAAK,CAACW,iBAAiB,CAAC,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGb,EAAE,CAAC2B,qBAAqB,EAAE;IAC1F,CAAK,EAAE,MAAM;MACPjB,MAAM,EAAE;IACd,CAAK,CAAC;EACN,CAAG,CAAC;EACF,OAAO;IACLM,UAAU;IACVzB,QAAQ;IACRP,UAAU;IACVoC,WAAW;IACXH,KAAK;IACLC,MAAM;IACNhC,IAAI;IACJiC,WAAW;IACXT;EACJ,CAAG;AACH","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}